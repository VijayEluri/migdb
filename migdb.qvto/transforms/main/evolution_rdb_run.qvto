import evolution_rdb;
import builder_rdb;
modeltype RDB uses "http://www.collectionspro.eu/jam/mm/rdb";
transformation evolutionAtomicRdbRun(in inStructure : RDB,in inOperations : RDB ,out outStructure : RDB);


main() {
	var operations : OrderedSet(RDB::ops::ModelOperation) := inOperations.rootObjects()![RDB::Operations].operations;
	//default copying root object to output model
	inStructure.rootObjects().deepclone();
	var structure : RDB::Structure := outStructure.rootObjects()![RDB::Structure];
	
//	if(operations->size() > 1)then{
//		log("Error during performing test. Input model contains more operations than one");
//	}else{
		var isValid : Boolean := true;
		operations->forEach(op){
			if(op.isValid(structure))then{
				op.apply(structure);
			}else{
				isValid := false;
			}endif;
		};
//	}endif;
	log("evolution rdb finished");		 
}